import"./modulepreload-polyfill-B5Qt9EMX.js";const r=[{id:"p1",name:"상품1",price:1e4,stock:50},{id:"p2",name:"상품2",price:2e4,stock:30},{id:"p3",name:"상품3",price:3e4,stock:20},{id:"p4",name:"상품4",price:15e3,stock:0},{id:"p5",name:"상품5",price:25e3,stock:10}],y=()=>`<div id="cart-items"></div>
        <div id="cart-total" class="text-xl font-bold my-4"></div>`,g=()=>`<select id="product-select" class="border rounded p-2 mr-2"></select>
        <button id="add-to-cart" class="bg-blue-500 text-white px-4 py-2 rounded">추가</button>
        <div id="stock-status" class="text-sm text-gray-500 mt-2"></div>`;function h(){return`<div class="bg-gray-100 p-8">
        <div class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8">
            <h1 class="text-2xl font-bold mb-4">장바구니</h1>
            ${y()} ${g()}
        </div>
    </div>`}const x=()=>{const n=document.getElementById("product-select");n.innerHTML="",r.forEach(function(c){const t=document.createElement("option");t.value=c.id,t.textContent=c.name+" - "+c.price+"원",c.stock===0&&(t.disabled=!0),n.appendChild(t)})},C=()=>{const n=document.getElementById("stock-status");let c="";r.forEach(function(t){t.stock<5&&(c+=t.name+": "+(t.stock>0?"재고 부족 ("+t.stock+"개 남음)":"품절")+`
`)}),n.textContent=c},b=()=>{const n=r[Math.floor(Math.random()*r.length)];Math.random()<.3&&n.stock>0&&(n.price=Math.round(n.price*.8),alert("번개세일! "+n.name+"이(가) 20% 할인 중입니다!"),x())},k=()=>{},I=n=>{n||localStorage.removeItem("lastSelectedItem"),localStorage.setItem("lastSelectedItem",n)},p=()=>{const n=document.getElementById("cart-total"),c=document.getElementById("cart-items");let t=0,e=0;const a=c.children;let o=0;for(let d=0;d<a.length;d++)(function(){let i;for(let m=0;m<r.length;m++)if(r[m].id===a[d].id){i=r[m];break}const u=parseInt(a[d].querySelector("span").textContent.split("x ")[1]),f=i.price*u;let l=0;e+=u,o+=f,u>=10&&(i.id==="p1"?l=.1:i.id==="p2"?l=.15:i.id==="p3"?l=.2:i.id==="p4"?l=.05:i.id==="p5"&&(l=.25)),t+=f*(1-l)})();let s=0;if(e>=30){const d=t*.25,i=o-t;d>i?(t=o*(1-.25),s=.25):s=(o-t)/o}else s=(o-t)/o;if(new Date().getDay()===2&&(t*=1-.1,s=Math.max(s,.1)),n.textContent="총액: "+Math.round(t)+"원",s>0){const d=document.createElement("span");d.className="text-green-500 ml-2",d.textContent="("+(s*100).toFixed(1)+"% 할인 적용)",n.appendChild(d)}C(),v(t)},v=n=>{const c=document.getElementById("cart-total");let t=document.getElementById("loyalty-points");const e=Math.floor(n/1e3)||0;t||(t=document.createElement("span"),t.id="loyalty-points",t.className="text-blue-500 ml-2",c.appendChild(t)),t.textContent="(포인트: "+e+")"};function E(){const n=document.getElementById("app");n.innerHTML=h(),I(),x(),p(),setTimeout(function(){setInterval(b(),3e4)},Math.random()*1e4),setTimeout(function(){setInterval(k(),6e4)},Math.random()*2e4)}E();const S=document.getElementById("add-to-cart");S.addEventListener("click",function(){const n=document.getElementById("product-select"),c=document.getElementById("cart-items"),t=n.value,e=r.find(function(a){return a.id===t});if(e&&e.stock){const a=document.getElementById(e.id);if(a){const o=a.querySelector("span").textContent.split("x ")[1],s=parseInt(o)+1;s<=e.stock?(a.querySelector("span").textContent=`${e.name} - ${e.price} 원 x ${s}`,e.stock--):alert("재고가 부족합니다.")}else{const o=document.createElement("div");o.id=e.id,o.className="flex justify-between items-center mb-2";const s=`<span>${e.name} - ${e.price}원 x 1</span>`,d=`<button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${e.id}" data-change="-1">-</button>`,i=`<button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${e.id}" data-change="1">+</button>`,u=`<button class="remove-item bg-red-500 text-white px-2 py-1 rounded" data-product-id="${e.id}">삭제</button>`;o.innerHTML=`<div>${s}${d}${i}${u}</div>`,c.appendChild(o),e.stock--}p(),I(t)}});const B=document.getElementById("cart-items");B.addEventListener("click",function(n){const c=n.target;if(c.classList.contains("quantity-change")||c.classList.contains("remove-item")){const t=c.dataset.productId,e=document.getElementById(t),a=r.find(function(o){return o.id===t});if(c.classList.contains("quantity-change")){const o=parseInt(c.dataset.change),s=parseInt(e.querySelector("span").textContent.split("x ")[1])+o;s>0&&s<=a.stock+parseInt(e.querySelector("span").textContent.split("x ")[1])?(e.querySelector("span").textContent=e.querySelector("span").textContent.split("x ")[0]+"x "+s,a.stock-=o):s<=0?(e.remove(),a.stock-=o):alert("재고가 부족합니다.")}else if(c.classList.contains("remove-item")){const o=parseInt(e.querySelector("span").textContent.split("x ")[1]);a.stock+=o,e.remove()}p()}});
